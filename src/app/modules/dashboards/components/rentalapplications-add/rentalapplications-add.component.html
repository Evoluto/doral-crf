<div class="card">
  <div class="card-body">
    <mat-horizontal-stepper [linear]="true"
      #stepper>

      <!-- Step one start -->
      <mat-step [stepControl]="firstFormGroup">
        <form [formGroup]="firstFormGroup"
          (ngSubmit)="onStepOneSubmit()">
          <ng-template matStepLabel>Requirements</ng-template>
          <br>
          <span>Display Program Information here</span>
          <hr style="background-color: #bfcced">

          <div class="stepper-button-row">
            <button mat-flat-button
              matStepperNext
              class="btn-dfa-dark">Next</button>
          </div>
        </form>
      </mat-step>
      <!-- Step one end -->

      <!-- Step two start -->
      <mat-step [stepControl]="secondFormGroup">
        <form [formGroup]="secondFormGroup"
          (ngSubmit)="onStepTwoSubmit()">
          <ng-template matStepLabel>Contact Info</ng-template>
          <br>
          <div class="row">
            <div class="col-md-12">
              <p>
                <span class="bolt">Primary Applicant (contact person):</span>
              </p>
            </div>
            <div class="col-md-12">
              <input class="form-control"
                placeholder="Enter Primary Applicant ..."
                formControlName="primary_applicant">
            </div>
          </div>
          <div class="row">
            <div class="col-md-12">
              <p>
                <span class="bolt">Home Address:</span>
              </p>
            </div>
            <div class="col-md-12">
              <input class="form-control"
                placeholder="Enter Home Address ..."
                rows="4"
                formControlName="home_address">
            </div>
          </div>
          <div class="row">
            <div class="col-md-12">
              <p>
                <span class="bolt">Email:</span>
              </p>
            </div>
            <div class="col-md-12">
              <input type="email" class="form-control"
                placeholder="Enter Email ..."
                formControlName="email">
            </div>
          </div>
          <div class="row">
            <div class="col-md-12">
              <p>
                <span class="bolt">Phone:</span>
              </p>
            </div>
            <div class="col-md-12">
              <input class="form-control"
                placeholder="Enter Phone ..."
                formControlName="phone">
            </div>
          </div>
          <br>
          <div class="stepper-button-row">
            <button matStepperPrevious
              class="btn-dfa-light"
              mat-flat-button>Back</button>
            <button mat-flat-button
              matStepperNext
              class="btn-dfa-dark">Next</button>
          </div>
        </form>
      </mat-step>
      <!-- Step two end -->

      <!-- Step three start -->
      <mat-step [stepControl]="thirdFormGroup">
        <form [formGroup]="thirdFormGroup"
          (ngSubmit)="onStepThreeSubmit()">
          <ng-template matStepLabel>Rental Info</ng-template>
          <br>
          <div class="row">
            <div class="col-md-12">
              <p>
                <span class="bolt">Organization Type (dropdown):</span>
              </p>
            </div>
            <div class="col-md-12">
              <input class="form-control"
                placeholder="Enter Organization Type ..."
                formControlName="organization_type">
            </div>
          </div>
          <div class="row">
            <div class="col-md-12">
              <p>
                <span class="bolt">Rental Legal Name (as listed in Sunbiz.org):</span>
              </p>
            </div>
            <div class="col-md-12">
              <input class="form-control"
                placeholder="Enter Rental Legal Name ..."
                formControlName="rental_legal_name">
            </div>
          </div>
          <div class="row">
            <div class="col-md-12">
              <p>
                <span class="bolt">Doing Rental As (if different than legal name):</span>
              </p>
            </div>
            <div class="col-md-12">
              <input class="form-control"
                placeholder="Enter DBA ..."
                formControlName="dba">
            </div>
          </div>
          <div class="row">
            <div class="col-md-12">
              <p>
                <span class="bolt">EIN (Federal Employer Identification Number):</span>
              </p>
            </div>
            <div class="col-md-12">
              <input type="email" class="form-control"
                placeholder="Enter EIN ..."
                formControlName="ein">
            </div>
          </div>
          <div class="row">
            <div class="col-md-12">
              <p>
                <span class="bolt">City of Doral Rental Tax Receipt (BTR) Number:</span>
              </p>
            </div>
            <div class="col-md-12">
              <input class="form-control"
                placeholder="Enter BTR ..."
                formControlName="btr">
            </div>
          </div>
          <div class="row">
            <div class="col-md-12">
              <p>
                <span class="bolt">Mailing Address:</span>
              </p>
            </div>
            <div class="col-md-12">
              <input class="form-control"
                placeholder="Enter Mailing Address ..."
                formControlName="mailing_address">
            </div>
          </div>
          <div class="row">
            <div class="col-md-12">
              <p>
                <span class="bolt">Rental Property Address:</span>
              </p>
            </div>
            <div class="col-md-12">
              <input class="form-control"
                placeholder="Enter Rental Property Address ..."
                formControlName="rental_property_address">
            </div>
          </div>
          <div class="row">
            <div class="col-md-12">
              <p>
                <span class="bolt">Primary Rental Activity:</span>
              </p>
            </div>
            <div class="col-md-12">
              <input class="form-control"
                placeholder="Enter Primary Rental Activity ..."
                formControlName="primary_rental_activity">
            </div>
          </div>
          <br>
          <div class="stepper-button-row">
            <button matStepperPrevious
              class="btn-dfa-light"
              mat-flat-button>Back</button>
            <button mat-flat-button
              *ngIf="thirdFormStatus"
              matStepperNext
              class="btn-dfa-dark">Next</button>
          </div>
        </form>
      </mat-step>
      <!-- Step three end -->

      <!-- Step four start -->
      <mat-step [stepControl]="fourthFormGroup">
        <form [formGroup]="fourthFormGroup"
          (ngSubmit)="onStepFourSubmit()">
          <ng-template matStepLabel>Rental Details</ng-template>
          <br>
          <div class="row">
            <div class="col-md-12">
              <p>
                <span class="bolt">Number of Employees (2019 Taxes):</span>
              </p>
            </div>
            <div class="col-md-12">
              <input class="form-control"
                placeholder="Enter Number of Employees (2019 Taxes) ..."
                formControlName="number_of_employees_last_year">
            </div>
          </div>
          <div class="row">
            <div class="col-md-12">
              <p>
                <span class="bolt">Current Number of Employees:</span>
              </p>
            </div>
            <div class="col-md-12">
              <input class="form-control"
                placeholder="Enter Current Number of Employees ..."
                formControlName="current_number_of_employees">
            </div>
          </div>
          <div class="row">
            <div class="col-md-12">
              <p>
                <span class="bolt">Date Rental Established:</span>
              </p>
            </div>
            <div class="col-md-12">
              <input class="form-control"
                placeholder="Enter Date Rental Est. ..."
                formControlName="date_rental_established">
            </div>
          </div>
          <div class="row">
            <div class="col-md-12">
              <p>
                <span class="bolt">Does Your Rental (dropdown):</span>
              </p>
            </div>
            <div class="col-md-12">
              <input type="email" class="form-control"
                placeholder="Enter Own or Lease ..."
                formControlName="own_or_lease">
            </div>
          </div>
          <div class="row">
            <div class="col-md-12">
              <p>
                <span class="bolt">Monthly Rent/Mortgage:</span>
              </p>
            </div>
            <div class="col-md-12">
              <input class="form-control"
                placeholder="Enter Monthly Rent/Mortgage ..."
                formControlName="monthly_rent_mortgage">
            </div>
          </div>
          <div class="row">
            <div class="col-md-12">
              <p>
                <span class="bolt">Last Month Rent/Mortgage Paid:</span>
              </p>
            </div>
            <div class="col-md-12">
              <input class="form-control"
                placeholder="Enter Last Month Rent/Mortgage Paid ..."
                formControlName="last_rent_mortgage_paid">
            </div>
          </div>
          <div class="row">
            <div class="col-md-12">
              <p>
                <span class="bolt">Is Your Rental a National Chain Store or Franchise (checkbox):</span>
              </p>
            </div>
            <div class="col-md-12">
              <input class="form-control"
                placeholder="Is Your Rental a National Chain Store or Franchise ..."
                formControlName="national_chain_or_franchise">
            </div>
          </div>
          <br>
          <div class="stepper-button-row">
            <button matStepperPrevious
              class="btn-dfa-light"
              mat-flat-button>Back</button>
            <button mat-flat-button
              *ngIf="fourthFormStatus"
              matStepperNext
              class="btn-dfa-dark">Next</button>
          </div>
        </form>
      </mat-step>
      <!-- Step four end -->

      <!-- Step five start -->
      <mat-step [stepControl]="fifthFormGroup">
        <form [formGroup]="fifthFormGroup"
          (ngSubmit)="onStepFiveSubmit()">
          <ng-template matStepLabel>Applicants</ng-template>
          <br>
          <div class="row">
            <div class="col-md-3">
              <p>
                <span class="bolt">Applicant 1 Name:</span>
              </p>
            </div>
            <div class="col-md-3">
              <input class="form-control"
                placeholder="Enter Applicant 1 Name ..."
                formControlName="applicant1_name">
            </div>
            <div class="col-md-3">
              <p>
                <span class="bolt">Ownership %:</span>
              </p>
            </div>
            <div class="col-md-3">
              <input class="form-control"
                placeholder="Enter Applicant 1 Ownership % ..."
                formControlName="applicant1_ownership_percentage">
            </div>
          </div>
          <div class="row">
            <div class="col-md-3">
              <p>
                <span class="bolt">Applicant 2 Name:</span>
              </p>
            </div>
            <div class="col-md-3">
              <input class="form-control"
                placeholder="Enter Applicant 2 Name ..."
                formControlName="applicant2_name">
            </div>
            <div class="col-md-3">
              <p>
                <span class="bolt">Ownership %:</span>
              </p>
            </div>
            <div class="col-md-3">
              <input class="form-control"
                placeholder="Enter Applicant 2 Ownership % ..."
                formControlName="applicant2_ownership_percentage">
            </div>
          </div>
          <div class="row">
            <div class="col-md-3">
              <p>
                <span class="bolt">Applicant 3 Name:</span>
              </p>
            </div>
            <div class="col-md-3">
              <input class="form-control"
                placeholder="Enter Applicant 3 Name ..."
                formControlName="applicant3_name">
            </div>
            <div class="col-md-3">
              <p>
                <span class="bolt">Ownership %:</span>
              </p>
            </div>
            <div class="col-md-3">
              <input class="form-control"
                placeholder="Enter Applicant 3 Ownership % ..."
                formControlName="applicant3_ownership_percentage">
            </div>
          </div>
          <div class="row">
            <div class="col-md-3">
              <p>
                <span class="bolt">Applicant 4 Name:</span>
              </p>
            </div>
            <div class="col-md-3">
              <input class="form-control"
                placeholder="Enter Applicant 4 Name ..."
                formControlName="applicant4_name">
            </div>
            <div class="col-md-3">
              <p>
                <span class="bolt">Ownership %:</span>
              </p>
            </div>
            <div class="col-md-3">
              <input class="form-control"
                placeholder="Enter Applicant 4 Ownership % ..."
                formControlName="applicant4_ownership_percentage">
            </div>
          </div>
          <br>
          <div class="stepper-button-row">
            <button matStepperPrevious
              class="btn-dfa-light"
              mat-flat-button>Back</button>
            <button mat-flat-button
              *ngIf="fifthFormStatus"
              matStepperNext
              class="btn-dfa-dark">Next</button>
          </div>
        </form>
      </mat-step>
      <!-- Step five end -->


      <!-- Step six start -->
      <mat-step [stepControl]="sixthFormGroup">
        <form [formGroup]="sixthFormGroup"
          (ngSubmit)="onStepSixSubmit()">
          <ng-template matStepLabel>Financials</ng-template>
          <br>
          <div class="row">
            <div class="col-md-3">
              <p>
                <span class="bolt">Grant Amount Requested($10,000 max):</span>
              </p>
            </div>
            <div class="col-md-3">
              <input class="form-control"
                placeholder="Enter Grant Amount Requested ..."
                formControlName="amount_requested">
            </div>
            <div class="col-md-3">
              <p>
                <span class="bolt">Estimated Loss:</span>
              </p>
            </div>
            <div class="col-md-3">
              <input class="form-control"
                placeholder="Enter Estimated Loss ..."
                formControlName="estimated_loss">
            </div>
          </div>
          <div class="row">
            <div class="col-md-12">
              <p>
                <span class="bolt">Rental Financial Summary:</span>
              </p>
            </div>
          </div>
          <div class="row">
            <div class="col-md-12">
              <table>
                <thead>
                  <th>Type of Financial Info</th>
                  <th>2019</th>
                  <th>2020 (January - September)</th>
                </thead>
                <tr>
                  <td>Gross Revenues</td>
                  <td><input class="form-control"
                    placeholder="Enter 2019 Gross Revenues ..."
                    formControlName="gross_revenue_last_year"></td>
                  <td><input class="form-control"
                    placeholder="Enter 2020 Gross Revenues ..."
                    formControlName="gross_revenue_this_year"></td>
                </tr>
                <tr>
                  <td>Total Payroll Expense</td>
                  <td><input class="form-control"
                    placeholder="Enter 2019 Total Payroll Expense ..."
                    formControlName="payroll_last_year"></td>
                  <td><input class="form-control"
                    placeholder="Enter 2020 Total Payroll Expense ..."
                    formControlName="payroll_this_year"></td>
                </tr>
                <tr>
                  <td>Pre-Tax Profit</td>
                  <td><input class="form-control"
                    placeholder="Enter 2019 Pre-Tax Profit ..."
                    formControlName="pre_tax_profit_last_year"></td>
                  <td><input class="form-control"
                    placeholder="Enter 2020 Pre-Tax Profit ..."
                    formControlName="pre_tax_profit_this_year"></td>
                </tr>
              </table>
            </div>
          </div>
          <div class="row">
            <div class="col-md-12">
              <p>
                <span class="bolt">Describe the Costs you Seek to Cover with the Reimbursement Grant:</span>
              </p>
            </div>
            <div class="col-md-12">
              <textarea class="form-control"
                rows=5
                placeholder="Describe the Costs you Seek to Cover with the Reimbursement Grant ..."
                formControlName="costs_to_recover"></textarea>
            </div>
          </div>
          <br>
          <div class="stepper-button-row">
            <button matStepperPrevious
              class="btn-dfa-light"
              mat-flat-button>Back</button>
            <button mat-flat-button
              *ngIf="sixthFormStatus"
              matStepperNext
              class="btn-dfa-dark">Next</button>
          </div>
        </form>
      </mat-step>
      <!-- Step six end -->

      <!-- Step seven start -->
      <mat-step [completed]="isCompletedStepSeven">

        <ng-template matStepLabel>Documents</ng-template>
        <br>

        <div class="row">
          <div class="col-md-12">
            <p>
              <strong class="bolt">Documentation : </strong>Documents uploaded here are only for those related
              application and pre-planning activities. For invoice
              and expenditure related documentation, please upload via the Payment Request module.
            </p>
          </div>
        </div>
        <br>

        <div *ngIf="recordId"
          class="card bg-dfa">
          <div class="card-header">Existing Documents</div>
          <div class="card-body">
            <table id="doctable"
              class="table">
              <tbody *ngIf="applicationEditDocumentData.length === 0">
                <tr>
                  <td colspan="2">
                    No attachments.
                  </td>
                </tr>
              </tbody>
              <tbody *ngIf="applicationEditDocumentData.length > 0">
                <tr *ngFor="let aed of applicationEditDocumentData"
                  style="border-top:none !important">
                  <td>
                    <span>{{aed.document_title}}</span>
                  </td>
                  <td>
                    <span>{{aed.document_type_selection}}</span>
                  </td>
                  <td>
                    <span>{{aed.document}}</span>
                  </td>
                  <td class="text-right">
                    <button type="button"
                      class="btn btn-sm btn-circle"
                      (click)="downloadFile(aed)">
                      <i class="fa fa-download text-success"></i>
                    </button>
                    <button type="button"
                      class="btn btn-sm btn-circle"
                      (click)="deleteDocument(aed.id)">
                      <i class="fa fa-trash text-danger"></i>
                    </button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <div class="card bg-dfa">
          <div class="card-header">
            Add New documents
            <button class="btn btn-sm btn-rounded btn-success float-right"
              (click)="addDocumentFormRow()">
              <i class="fa fa-plus"></i>
            </button>
          </div>
          <div class="card-body">
            <form (ngSubmit)="onStepFourSubmit()">
              <span *ngIf="documents.length === 0">Click on Plus button to add documents.</span>
              <br>

              <table class="table table-bordered">
                <tr *ngFor="let doc of documents">
                  <td>
                    <select [value]="documentTypes[doc.tempId]"
                      name="documentTypes[doc.tempId]"
                      class="form-control"
                      (change)="onChangeDocumentType(doc.tempId,$event.target.value)">
                      <option value=""
                        hidden>- Select type -</option>
                      <option value="{{opt.value}}"
                        *ngFor="let opt of documentSelectionTypes">
                        {{opt.name}}
                      </option>
                    </select>
                  </td>
                  <td>
                    <input class="form-control"
                      type="text"
                      (change)="onChangeDocumentTitle(doc.tempId,$event.target.value)"
                      [value]="documentTitles[doc.tempId]"
                      name="documentTitles[doc.tempId]"
                      placeholder="Document Title">
                  </td>
                  <td>
                    <div class="col-md-10">
                      <input type="file"
                        class="form-control-file form-control-sm"
                        id="add_file"
                        (change)="handleUpload(doc.tempId,$event)">
                    </div>
                  </td>
                  <td>
                    <button (click)="removeDocumentRow(doc.tempId)"
                      class="btn btn-sm btn-rounded btn-danger">
                      <i class="fa fa-minus"></i>
                    </button>
                  </td>
                </tr>
              </table>

              <br>
              <div class="stepper-button-row">
                <button matStepperPrevious
                  class="btn-dfa-light"
                  mat-flat-button>Back</button>
                <button mat-flat-button
                  matStepperNext
                  class="btn-dfa-dark">Next</button>
              </div>
            </form>
          </div>
        </div>
      </mat-step>
      <!-- Step seven end -->

      <!-- Step eight start -->
      <mat-step>
        <ng-template matStepLabel>Certification</ng-template>
        <br>

        <div [hidden]="!loading"
          class="alert alert-success"
          style="font-size: 30px;">
          <i class="fa fa-cog fa-spin"></i> Saving ... (Do not refresh or close browser window)
        </div>

        <form [hidden]="loading"
          [formGroup]="eighthFormGroup"
          (ngSubmit)="onStepEightSubmit()">

          <table class="table table-bordered">
            <tr>
              <td width="4%">
                <mat-checkbox class="example-margin"
                  formControlName="certify">
                </mat-checkbox>
              </td>
              <td width="96%">
                <p [ngClass]="{'field-has-error': eighthFormGroup.get('certify').hasError('required') }">
                  I certify ....
                </p>
              </td>
            </tr>
            <tr>
              <td colspan="2">
                <div class="row">
                  <div class="col-md-6">
                    <div class="form-group">
                      <label>Certifier Name</label>
                      <input type="text"
                        formControlName="certifier_name"
                        placeholder="Certifier Name"
                        class="form-control">
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-group">
                      <label>Certifier Title</label>
                      <input type="text"
                        formControlName="certifier_title"
                        placeholder="Certifier Title"
                        class="form-control">
                    </div>
                  </div>
                </div>
              </td>
            </tr>
          </table>

          <div class="stepper-button-row">
            <button matStepperPrevious
              class="btn-dfa-light"
              mat-flat-button>Back</button>
            <button mat-flat-button
              class="btn-dfa-dark"
              type="submit">Save</button>
            <button mat-flat-button
              class="btn-dark"
              type="button"
              (click)="cancelChanges(discardchanges)">Cancel</button>
          </div>
        </form>

      </mat-step>
      <!-- Step Eight end -->

    </mat-horizontal-stepper>
  </div>
</div>

<ng-template #discardchanges
  let-modal>
  <div class="modal-header">
    <h4 class="modal-title"
      id="modal-basic-title">
      {{modelConfig.title}}
    </h4>
  </div>
  <div class="modal-body">
    <div class="row">
      <div class="col-md-12">
        Are you sure you want to discard all changes and continue ?
      </div>
    </div>
    <br>
    <div class="row">
      <div class="col-md-12">
        <button type="button"
          class="btn btn-success"
          (click)="redirectToApps(true)">Yes</button>
        <button type="button"
          class="btn btn-dark"
          (click)="modal.close('discard')">No</button>
      </div>
    </div>
  </div>
</ng-template>