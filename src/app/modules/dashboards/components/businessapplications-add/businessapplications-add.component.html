<div class="card">
  <div class="card-body">
    <mat-horizontal-stepper [linear]="true"
      #stepper>

      <!-- Step one start -->
      <mat-step [stepControl]="firstFormGroup">
        <form [formGroup]="firstFormGroup"
          (ngSubmit)="onStepOneSubmit()">
          <ng-template matStepLabel>Requirements<br>Requisitos</ng-template>
          <br>
          <span>The Doral CARES Small Business Assistance Grant provides financial assistance to small businesses within the city that have been economically impacted by the COVID-19 pandemic. The program provides eligible businesses with a one-time assistance grant of up to $10,000.00 for allowable specified COVID relief. The reimbursement grant program is intended to help small businesses that are not part of a national chain or franchise to recoup COVID-related expenses incurred between March 12, 2020 and September 30, 2020. Expenses may include rent, employee salaries, inventory, insurance, communications, technological upgrades, training, cleaning, and COVID prevention supplies related to the pandemic. Grants will be considered on a first-come first-served basis and will be awarded to eligible businesses until funds are expended. The amount of the grant will be based on the expenses submitted and funding availability.</span>
          <hr style="background-color: #bfcced">
          <span>La Subvención de Asistencia para Pequeñas Empresas Doral CARES brinda asistencia financiera a las pequeñas empresas dentro de la ciudad que se han visto afectadas económicamente por la pandemia COVID-19. El programa proporciona a las empresas elegibles una subvención de asistencia única de hasta $ 10,000.00 para el alivio COVID especificado permitido. El programa de subvenciones de reembolso está destinado a ayudar a las pequeñas empresas que no forman parte de una cadena o franquicia nacional a recuperar los gastos relacionados con COVID incurridos entre el 12 de marzo de 2020 y el 30 de septiembre de 2020. Los gastos pueden incluir alquiler, salarios de empleados, inventario, seguros, comunicaciones, actualizaciones tecnológicas, capacitación, limpieza y suministros de prevención de COVID relacionados con la pandemia. Las subvenciones se considerarán por orden de llegada y se otorgarán a empresas elegibles hasta que se gasten los fondos. El monto de la subvención se basará en los gastos presentados y la disponibilidad de fondos.</span>
          <hr style="background-color: #bfcced">

          <div class="stepper-button-row">
            <button mat-flat-button
              matStepperNext
              class="btn-dfa-dark">Next</button>
            <!-- <button mat-flat-button
              type="button"
              (click)="saveExit('firstFormGroup')"
              class="btn-info">Save Draft and Exit
            </button> -->
          </div>
        </form>
      </mat-step>
      <!-- Step one end -->

      <!-- Step two start -->
      <mat-step [stepControl]="secondFormGroup">
        <form [formGroup]="secondFormGroup"
          (ngSubmit)="onStepTwoSubmit()">
          <ng-template matStepLabel>Contact Info<br>Información de Contacto</ng-template>
          <br>
          <div class="row">
            <div class="col-md-6">
              <p>
                <span class="bolt">Primary Applicant (contact person):</span>
              </p>
              <input class="form-control"
                placeholder="Enter Primary Applicant ..."
                formControlName="primary_applicant">
            </div>
            <div class="col-md-6">
              <p>
                <span class="bolt">Home Address:</span>
              </p>
              <input class="form-control"
                placeholder="Enter Home Address ..."
                rows="4"
                formControlName="home_address">
            </div>
          </div>
          <br>
          <div class="row">
            <div class="col-md-6">
              <p>
                <span class="bolt">Email:</span>
              </p>
              <input type="email"
                class="form-control"
                placeholder="Enter Email ..."
                formControlName="email">
            </div>
            <div class="col-md-6">
              <p>
                <span class="bolt">Phone:</span>
              </p>
              <div class="col-md-6">
                <input class="form-control"
                  placeholder="Enter Phone ..."
                  formControlName="phone">
              </div>
            </div>
          </div>
          <br>
          <div class="stepper-button-row">
            <button matStepperPrevious
              class="btn-dfa-light"
              mat-flat-button>Back</button>
            <button mat-flat-button
              matStepperNext
              class="btn-dfa-dark">Next</button>
            <button mat-flat-button
              type="button"
              (click)="saveExit('secondFormGroup')"
              class="btn-info">Save Draft and Exit
            </button>
            <button mat-flat-button
              class="btn-dark"
              type="button"
              (click)="cancelChanges(discardchanges)">Cancel</button>
          </div>
        </form>
      </mat-step>
      <!-- Step two end -->

      <!-- Step three start -->
      <mat-step [stepControl]="thirdFormGroup">
        <form [formGroup]="thirdFormGroup"
          (ngSubmit)="onStepThreeSubmit()">
          <ng-template matStepLabel>Business Info<br>Información de Negocios</ng-template>
          <br>
          <div class="row">
            <div class="col-md-4">
              <p>
                <span class="bolt">Organization Type:</span>
              </p>
              <select class="form-control"
                formControlName="organization_type">
                <option value=""
                  hidden>- Select Organization Type -</option>
                <option *ngFor="let ot of organizationTypes"
                  value="{{ot.value}}">{{ot.name}}</option>
              </select>
            </div>
            <div class="col-md-4">
              <p>
                <span class="bolt">Business Legal Name (as listed in Sunbiz.org):</span>
              </p>
              <input class="form-control"
                placeholder="Enter Business Legal Name ..."
                formControlName="business_legal_name">
            </div>
            <div class="col-md-4">
              <p>
                <span class="bolt">Doing Business As (if different than legal name):</span>
              </p>
              <input class="form-control"
                placeholder="Enter DBA ..."
                formControlName="dba">
            </div>
          </div>
          <br>
          <div class="row">
            <div class="col-md-4">
              <p>
                <span class="bolt">EIN (Federal Employer Identification Number):</span>
              </p>
              <input type="email"
                class="form-control"
                placeholder="Enter EIN ..."
                formControlName="ein">
            </div>
            <div class="col-md-4">
              <p>
                <span class="bolt">City of Doral Business Tax Receipt (BTR) Number:</span>
              </p>
              <input class="form-control"
                placeholder="Enter BTR ..."
                formControlName="btr">
            </div>
            <div class="col-md-4">
              <p>
                <span class="bolt">Primary Business Activity:</span>
              </p>
              <input class="form-control"
                placeholder="Enter Primary Business Activity ..."
                formControlName="business_activity">
            </div>
          </div>
          <br>
          <div class="row">
            <div class="col-md-4">
              <p>
                <span class="bolt">Mailing Address:</span>
              </p>
              <input class="form-control"
                placeholder="Enter Mailing Address ..."
                formControlName="mailing_address">
            </div>
            <div class="col-md-4">
              <p>
                <span class="bolt">Business Property Address:</span>
              </p>
              <input class="form-control"
                placeholder="Enter Business Property Address ..."
                formControlName="business_property_address">
            </div>
          </div>
          <br>
          <div class="stepper-button-row">
            <button matStepperPrevious
              class="btn-dfa-light"
              mat-flat-button>Back</button>
            <button mat-flat-button
              matStepperNext
              class="btn-dfa-dark">Next</button>
            <button mat-flat-button
              type="button"
              (click)="saveExit('thirdFormGroup')"
              class="btn-info">Save Draft and Exit
            </button>
            <button mat-flat-button
              class="btn-dark"
              type="button"
              (click)="cancelChanges(discardchanges)">Cancel</button>
          </div>
        </form>
      </mat-step>
      <!-- Step three end -->

      <!-- Step four start -->
      <mat-step [stepControl]="fourthFormGroup">
        <form [formGroup]="fourthFormGroup"
          (ngSubmit)="onStepFourSubmit()">
          <ng-template matStepLabel>Business Details<br>Detalles de negocio</ng-template>
          <br>
          <div class="row">
            <div class="col-md-6">
              <p>
                <span class="bolt">Number of Employees (2019 Taxes):</span>
              </p>
              <input class="form-control"
                placeholder="Enter Number of Employees (2019 Taxes) ..."
                formControlName="number_of_employees_last_year">
            </div>
            <div class="col-md-6">
              <p>
                <span class="bolt">Current Number of Employees:</span>
              </p>
              <input class="form-control"
                placeholder="Enter Current Number of Employees ..."
                formControlName="number_of_employees_current">
            </div>
          </div>
          <br>
          <div class="row">
            <div class="col-md-6">
              <p>
                <span class="bolt">Date Business Established:</span>
              </p>
              <input class="form-control"
                placeholder="Enter Date Business Est. ..."
                formControlName="date_business_established">
            </div>
            <div class="col-md-6">
              <p>
                <span class="bolt">Does Your Business:</span>
              </p>
              <select class="form-control"
                formControlName="own_or_lease">
                <option value=""
                  hidden>- Select Own or Lease -</option>
                <option *ngFor="let ol of ownOrLease"
                  value="{{ol.id}}">{{ol.name}}</option>
              </select>
            </div>
          </div>
          <br>
          <div class="row">
            <div class="col-md-6">
              <p>
                <span class="bolt">Monthly Rent/Mortgage:</span>
              </p>
              <input class="form-control"
                placeholder="Enter Monthly Rent/Mortgage ..."
                formControlName="monthly_rent_mortgage">
            </div>
            <div class="col-md-6">
              <p>
                <span class="bolt">Last Month Rent/Mortgage Paid:</span>
              </p>
              <input class="form-control"
                placeholder="Enter Last Month Rent/Mortgage Paid ..."
                formControlName="last_rent_mortgage_paid">
            </div>
          </div>
          <br>
          <div class="row">
            <div class="col-md-6">
              <p>
                <span class="bolt">Is Your Business a National Chain Store or Franchise:
                  <mat-checkbox class="example-margin"
                    formControlName="national_chain_or_franchise">
                  </mat-checkbox>
                </span>
              </p>
            </div>
          </div>
          <br>
          <div class="stepper-button-row">
            <button matStepperPrevious
              class="btn-dfa-light"
              mat-flat-button>Back</button>
            <button mat-flat-button
              matStepperNext
              class="btn-dfa-dark">Next</button>
            <button mat-flat-button
              type="button"
              (click)="saveExit('fourthFormGroup')"
              class="btn-info">Save Draft and Exit
            </button>
            <button mat-flat-button
              class="btn-dark"
              type="button"
              (click)="cancelChanges(discardchanges)">Cancel</button>
          </div>
        </form>
      </mat-step>
      <!-- Step four end -->

      <!-- Step five start -->
      <mat-step [stepControl]="fifthFormGroup">
        <form [formGroup]="fifthFormGroup"
          (ngSubmit)="onStepFiveSubmit()">
          <ng-template matStepLabel>Applicants<br>Solicitantes</ng-template>
          <br>
          <div class="row">
            <div class="col-md-2">
              <p>
                <span class="bolt">Applicant 1 Name:</span>
              </p>
            </div>
            <div class="col-md-4">
              <input class="form-control"
                placeholder="Enter Applicant 1 Name ..."
                formControlName="applicant1_name">
            </div>
            <div class="col-md-2">
              <p>
                <span class="bolt">Ownership %:</span>
              </p>
            </div>
            <div class="col-md-2">
              <input class="form-control"
                placeholder="Enter Applicant 1 Ownership % ..."
                formControlName="applicant1_ownership_percentage">
            </div>
          </div>
          <div class="row">
            <div class="col-md-2">
              <p>
                <span class="bolt">Applicant 2 Name:</span>
              </p>
            </div>
            <div class="col-md-4">
              <input class="form-control"
                placeholder="Enter Applicant 2 Name ..."
                formControlName="applicant2_name">
            </div>
            <div class="col-md-2">
              <p>
                <span class="bolt">Ownership %:</span>
              </p>
            </div>
            <div class="col-md-2">
              <input class="form-control"
                placeholder="Enter Applicant 2 Ownership % ..."
                formControlName="applicant2_ownership_percentage">
            </div>
          </div>
          <div class="row">
            <div class="col-md-2">
              <p>
                <span class="bolt">Applicant 3 Name:</span>
              </p>
            </div>
            <div class="col-md-4">
              <input class="form-control"
                placeholder="Enter Applicant 3 Name ..."
                formControlName="applicant3_name">
            </div>
            <div class="col-md-2">
              <p>
                <span class="bolt">Ownership %:</span>
              </p>
            </div>
            <div class="col-md-2">
              <input class="form-control"
                placeholder="Enter Applicant 3 Ownership % ..."
                formControlName="applicant3_ownership_percentage">
            </div>
          </div>
          <div class="row">
            <div class="col-md-2">
              <p>
                <span class="bolt">Applicant 4 Name:</span>
              </p>
            </div>
            <div class="col-md-4">
              <input class="form-control"
                placeholder="Enter Applicant 4 Name ..."
                formControlName="applicant4_name">
            </div>
            <div class="col-md-2">
              <p>
                <span class="bolt">Ownership %:</span>
              </p>
            </div>
            <div class="col-md-2">
              <input class="form-control"
                placeholder="Enter Applicant 4 Ownership % ..."
                formControlName="applicant4_ownership_percentage">
            </div>
          </div>
          <br>
          <div class="stepper-button-row">
            <button matStepperPrevious
              class="btn-dfa-light"
              mat-flat-button>Back</button>
            <button mat-flat-button
              matStepperNext
              class="btn-dfa-dark">Next</button>
            <button mat-flat-button
              type="button"
              (click)="saveExit('fifthFormGroup')"
              class="btn-info">Save Draft and Exit
            </button>
            <button mat-flat-button
              class="btn-dark"
              type="button"
              (click)="cancelChanges(discardchanges)">Cancel</button>
          </div>
        </form>
      </mat-step>
      <!-- Step five end -->


      <!-- Step six start -->
      <mat-step [stepControl]="sixthFormGroup">
        <form [formGroup]="sixthFormGroup"
          (ngSubmit)="onStepSixSubmit()">
          <ng-template matStepLabel>Financials<br>Finanzas</ng-template>
          <br>
          <div class="row">
            <div class="col-md-3">
              <p>
                <span class="bolt">Grant Amount Requested ($10,000 max):</span>
              </p>
            </div>
            <div class="col-md-3">
              <input class="form-control"
                placeholder="Enter Grant Amount Requested ..."
                formControlName="amount_requested">
            </div>
            <div class="col-md-3">
              <p>
                <span class="bolt">Estimated Loss:</span>
              </p>
            </div>
            <div class="col-md-3">
              <input class="form-control"
                placeholder="Enter Estimated Loss ..."
                formControlName="estimated_loss">
            </div>
          </div>
          <div class="row">
            <div class="col-md-12">
              <p>
                <span class="bolt">Business Financial Summary:</span>
              </p>
            </div>
          </div>
          <div class="row">
            <div class="col-md-3">
            </div>
            <div class="col-md-9">
              <table width="100%" border="1">
                <thead>
                  <th>Type of Financial Info</th>
                  <th>2019</th>
                  <th>2020 (January - September)</th>
                </thead>
                <tr>
                  <th>Gross Revenues</th>
                  <td><input class="form-control"
                      placeholder="Enter 2019 Gross Revenues ..."
                      formControlName="gross_revenue_last_year"></td>
                  <td><input class="form-control"
                      placeholder="Enter 2020 Gross Revenues ..."
                      formControlName="gross_revenue_this_year"></td>
                </tr>
                <tr>
                  <th>Total Payroll Expense</th>
                  <td><input class="form-control"
                      placeholder="Enter 2019 Total Payroll Expense ..."
                      formControlName="payroll_last_year"></td>
                  <td><input class="form-control"
                      placeholder="Enter 2020 Total Payroll Expense ..."
                      formControlName="payroll_this_year"></td>
                </tr>
                <tr>
                  <th>Pre-Tax Profit</th>
                  <td><input class="form-control"
                      placeholder="Enter 2019 Pre-Tax Profit ..."
                      formControlName="pre_tax_profit_last_year"></td>
                  <td><input class="form-control"
                      placeholder="Enter 2020 Pre-Tax Profit ..."
                      formControlName="pre_tax_profit_this_year"></td>
                </tr>
              </table>
            </div>
          </div>
          <br>
          <div class="row">
            <div class="col-md-12">
              <p>
                <span class="bolt">Describe the Costs you Seek to Cover with the Reimbursement Grant:</span>
              </p>
            </div>
            <div class="col-md-12">
              <textarea class="form-control"
                rows=5
                placeholder="Describe the Costs you Seek to Cover with the Reimbursement Grant ..."
                formControlName="costs_to_recover"></textarea>
            </div>
          </div>
          <br>
          <div class="stepper-button-row">
            <button matStepperPrevious
              class="btn-dfa-light"
              mat-flat-button>Back</button>
            <button mat-flat-button
              matStepperNext
              class="btn-dfa-dark">Next</button>
            <button mat-flat-button
              type="button"
              (click)="saveExit('sixthFormGroup')"
              class="btn-info">Save Draft and Exit
            </button>
            <button mat-flat-button
              class="btn-dark"
              type="button"
              (click)="cancelChanges(discardchanges)">Cancel</button>
          </div>
        </form>
      </mat-step>
      <!-- Step six end -->

      <!-- Step seven start -->
      <mat-step [completed]="isCompletedStepSeven">

        <ng-template matStepLabel>Documents<br>Documentos</ng-template>
        <br>

        <div class="row">
          <div class="col-md-12">
            <p>
              <strong class="bolt">Documentation : </strong>
            </p>
          </div>
        </div>
        <br>
        <div class="card bg-dfa">
        <div class="card-header">Downloads</div>
        <div class="card-body">
          <table id="doctable" class="table">
            <tr>
              <td><a href="https://d3dr6irtq668i9.cloudfront.net/templates/W-9_Blank.pdf" target="_blank" download>W-9 (signed and dated)</a></td>
              <td><a href="https://d3dr6irtq668i9.cloudfront.net/templates/W-9_Blank.pdf" target="_blank" download>W-9 (firmado y fechado)</a></td>
            </tr>
            <tr>
              <td><a href="https://d3dr6irtq668i9.cloudfront.net/templates/City_of_Doral_Vendor_Registration_Form.pdf" target="_blank" download>Vendor Application (completed)</a></td>
              <td><a href="https://d3dr6irtq668i9.cloudfront.net/templates/City_of_Doral_Vendor_Registration_Form.pdf" target="_blank" download>Solicitud de proveedor (completada)</a></td>
            </tr>
            <tr>
              <td><a href="https://d3dr6irtq668i9.cloudfront.net/templates/City_of_Doral_Business_Entity_Affidavit.pdf" target="_blank" download>Business Entity Affidavit (signed, dated and notarized)</a></td>
              <td><a href="https://d3dr6irtq668i9.cloudfront.net/templates/City_of_Doral_Business_Entity_Affidavit.pdf" target="_blank" download>Declaración jurada de entidad comercial (firmada, fechada y notariada)</a></td>
            </tr>
          </table>
        </div>
      </div>
        <div *ngIf="recordId"
          class="card bg-dfa">
          <div class="card-header">Existing Documents</div>
          <div class="card-body">
            <table id="doctable"
              class="table">
              <tbody *ngIf="businessApplicationEditDocumentData.length === 0">
                <tr>
                  <td colspan="2">
                    No attachments.
                  </td>
                </tr>
              </tbody>
              <tbody *ngIf="businessApplicationEditDocumentData.length > 0">
                <tr *ngFor="let aed of businessApplicationEditDocumentData"
                  style="border-top:none !important">
                  <td>
                    <span>{{aed.document_title}}</span>
                  </td>
                  <td>
                    <span>{{aed.document_type_selection}}</span>
                  </td>
                  <td>
                    <span>{{aed.document}}</span>
                  </td>
                  <td class="text-right">
                    <button type="button"
                      class="btn btn-sm btn-circle"
                      (click)="downloadFile(aed)">
                      <i class="fa fa-download text-success"></i>
                    </button>
                    <button type="button"
                      class="btn btn-sm btn-circle"
                      (click)="deleteDocument(aed.id)">
                      <i class="fa fa-trash text-danger"></i>
                    </button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <div class="card bg-dfa">
          <div class="card-header">
            Add New documents
            <button class="btn btn-sm btn-rounded btn-success float-right"
              (click)="addDocumentFormRow()">
              <i class="fa fa-plus"></i>
            </button>
          </div>
          <div class="card-body">
            <form (ngSubmit)="onStepFourSubmit()">
              <span *ngIf="documents.length === 0">Click on Plus button to add documents.</span>
              <br>

              <table class="table table-bordered">
                <tr *ngFor="let doc of documents">
                  <td>
                    <select [value]="documentTypes[doc.tempId]"
                      name="documentTypes[doc.tempId]"
                      class="form-control"
                      (change)="onChangeDocumentType(doc.tempId,$event.target.value)">
                      <option value=""
                        hidden>- Select type -</option>
                      <option value="{{opt.id}}"
                        *ngFor="let opt of documentSelectionTypes">
                        {{opt.document_title}}
                      </option>
                    </select>
                  </td>
                  <td>
                    <input class="form-control"
                      type="text"
                      (change)="onChangeDocumentTitle(doc.tempId,$event.target.value)"
                      [value]="documentTitles[doc.tempId]"
                      name="documentTitles[doc.tempId]"
                      placeholder="Document Title">
                  </td>
                  <td>
                    <div class="col-md-10">
                      <input type="file"
                        class="form-control-file form-control-sm"
                        id="add_file"
                        (change)="handleUpload(doc.tempId,$event)">
                    </div>
                  </td>
                  <td>
                    <button (click)="removeDocumentRow(doc.tempId)"
                      class="btn btn-sm btn-rounded btn-danger">
                      <i class="fa fa-minus"></i>
                    </button>
                  </td>
                </tr>
              </table>

              <br>
              <div class="stepper-button-row">
                <button matStepperPrevious
                  class="btn-dfa-light"
                  mat-flat-button>Back</button>
                <button mat-flat-button
                  matStepperNext
                  class="btn-dfa-dark">Next</button>
                <button mat-flat-button
                  type="button"
                  (click)="saveExit(null)"
                  class="btn-info">Save Draft and Exit
                </button>
                <button mat-flat-button
                class="btn-dark"
                type="button"
                (click)="cancelChanges(discardchanges)">Cancel</button>
              </div>
            </form>
          </div>
        </div>
      </mat-step>
      <!-- Step seven end -->

      <!-- Step eight start -->
      <mat-step>
        <ng-template matStepLabel>Certification<br>Certificación</ng-template>
        <br>

        <form [formGroup]="eighthFormGroup"
          (ngSubmit)="onStepEightSubmit()">

          <table class="table table-bordered">
            <tr>
              <td width="4%">
                <mat-checkbox class="example-margin"
                  formControlName="certify">
                </mat-checkbox>
              </td>
              <td width="96%">
                <p [ngClass]="{'field-has-error': eighthFormGroup.get('certify').hasError('required') }">
                  I certify ....
                </p>
              </td>
            </tr>
            <tr>
              <td colspan="2">
                <div class="row">
                  <div class="col-md-6">
                    <div class="form-group">
                      <label>Certifier Name</label>
                      <input type="text"
                        formControlName="certifier_name"
                        placeholder="Certifier Name"
                        class="form-control">
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-group">
                      <label>Certifier Title</label>
                      <input type="text"
                        formControlName="certifier_title"
                        placeholder="Certifier Title"
                        class="form-control">
                    </div>
                  </div>
                </div>
              </td>
            </tr>
          </table>

          <div class="stepper-button-row">
            <button matStepperPrevious
              class="btn-dfa-light"
              mat-flat-button>Back</button>
            <button mat-flat-button
              class="btn-dfa-dark"
              type="submit">Save</button>
            <button mat-flat-button
              class="btn-dark"
              type="button"
              (click)="cancelChanges(discardchanges)">Cancel</button>
          </div>
        </form>

      </mat-step>
      <!-- Step Eight end -->

    </mat-horizontal-stepper>
  </div>
</div>

<ng-template #discardchanges
  let-modal>
  <div class="modal-header">
    <h4 class="modal-title"
      id="modal-basic-title">
      {{modelConfig.title}}
    </h4>
  </div>
  <div class="modal-body">
    <div class="row">
      <div class="col-md-12">
        Are you sure you want to discard all changes and continue ?
      </div>
    </div>
    <br>
    <div class="row">
      <div class="col-md-12">
        <button type="button"
          class="btn btn-success"
          (click)="redirectToApps(true)">Yes</button>
        <button type="button"
          class="btn btn-dark"
          (click)="modal.close('discard')">No</button>
      </div>
    </div>
  </div>
</ng-template>